CSE702025-LT8-NhÃ³m-9

Há»‡ Thá»‘ng Äiá»ƒm Danh Báº±ng Nháº­n Diá»‡n KhuÃ´n Máº·t

Tá»•ng Quan Dá»± Ãn

Dá»± Ã¡n phÃ¡t triá»ƒn má»™t há»‡ thá»‘ng Ä‘iá»ƒm danh tá»± Ä‘á»™ng tiÃªn tiáº¿n táº¡i Äáº¡i há»c Phenikaa, á»©ng dá»¥ng cÃ´ng nghá»‡ nháº­n diá»‡n khuÃ´n máº·t hiá»‡n Ä‘áº¡i. Há»‡ thá»‘ng tÃ­ch há»£p cÃ¡c thuáº­t toÃ¡n SCRFD Ä‘á»ƒ phÃ¡t hiá»‡n khuÃ´n máº·t vÃ  ArcFace Ä‘á»ƒ nháº­n diá»‡n danh tÃ­nh, mang láº¡i Ä‘á»™ chÃ­nh xÃ¡c cao trong mÃ´i trÆ°á»ng lá»›p há»c thá»±c táº¿. Giáº£i phÃ¡p nÃ y kháº¯c phá»¥c cÃ¡c háº¡n cháº¿ cá»§a phÆ°Æ¡ng phÃ¡p Ä‘iá»ƒm danh truyá»n thá»‘ng nhÆ° tá»‘n thá»i gian, dá»… sai sÃ³t vÃ  nguy cÆ¡ gian láº­n.



TÃ­nh NÄƒng ChÃ­nh





PhÃ¡t Hiá»‡n KhuÃ´n Máº·t: Sá»­ dá»¥ng SCRFD Ä‘á»ƒ phÃ¡t hiá»‡n khuÃ´n máº·t nhanh chÃ³ng vÃ  chÃ­nh xÃ¡c, ká»ƒ cáº£ trong Ä‘iá»u kiá»‡n Ã¡nh sÃ¡ng phá»©c táº¡p.



Nháº­n Diá»‡n KhuÃ´n Máº·t: á»¨ng dá»¥ng ArcFace Ä‘á»ƒ xÃ¡c minh danh tÃ­nh Ä‘Ã¡ng tin cáº­y, Ä‘áº£m báº£o tÃ­nh minh báº¡ch.



Xá»­ LÃ½ Thá»i Gian Thá»±c: Há»— trá»£ Ä‘iá»ƒm danh tá»©c thÃ¬, tiáº¿t kiá»‡m thá»i gian vÃ  tÄƒng hiá»‡u quáº£ quáº£n lÃ½.



Giá»›i Thiá»‡u Sinh ViÃªn







ThÃ´ng tin



Chi tiáº¿t





Há» vÃ  TÃªn



Nguyá»…n Minh DÆ°Æ¡ng





MÃ£ Sá»‘ Sinh ViÃªn



23010441





Lá»›p



KTPM-LT8





Email



23010441@st.phenikaa-uni.edu.vn





Vai TrÃ²



NgÆ°á»i thá»±c hiá»‡n chÃ­nh, chá»‹u trÃ¡ch nhiá»‡m thiáº¿t káº¿, triá»ƒn khai vÃ  Ä‘Ã¡nh giÃ¡ há»‡ thá»‘ng.





ChuyÃªn NgÃ nh



CÃ´ng nghá»‡ ThÃ´ng tin, chuyÃªn sÃ¢u vá» Thá»‹ GiÃ¡c MÃ¡y TÃ­nh.



LiÃªn Há»‡

Má»i tháº¯c máº¯c hoáº·c Ä‘Ã³ng gÃ³p Ã½ kiáº¿n, vui lÃ²ng liÃªn há»‡:
ğŸ“§ Email: 23010441@st.phenikaa-uni.edu.vn
ğŸ‘¤ NgÆ°á»i liÃªn há»‡: Nguyá»…n Minh DÆ°Æ¡ng

## Lá»£i Ã­ch khi tÃ­ch há»£p Kafka vÃ o há»‡ thá»‘ng

*(ÄÃ£ loáº¡i bá» Kafka, pháº§n nÃ y chá»‰ giá»¯ láº¡i náº¿u báº¡n muá»‘n tham kháº£o vá» tÃ­ch há»£p Kafka trong tÆ°Æ¡ng lai)*

## Khi Ä‘Ã£ cÃ³ Kafka, cÃ³ cáº§n giá»¯ láº¡i SQLite khÃ´ng?

*(ÄÃ£ loáº¡i bá» Kafka, há»‡ thá»‘ng hiá»‡n táº¡i chá»‰ sá»­ dá»¥ng SQLite Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u Ä‘iá»ƒm danh, ngÆ°á»i dÃ¹ng, sinh viÃªn...)*

## HÆ°á»›ng dáº«n cháº¡y Kafka trÃªn local Ä‘á»ƒ há»‡ thá»‘ng hoáº¡t Ä‘á»™ng

*(ÄÃ£ loáº¡i bá» Kafka, khÃ´ng cáº§n thá»±c hiá»‡n cÃ¡c bÆ°á»›c nÃ y náº¿u khÃ´ng sá»­ dá»¥ng Kafka trong há»‡ thá»‘ng cá»§a báº¡n)*

---

**TÃ³m láº¡i:**  
- LuÃ´n pháº£i cháº¡y Zookeeper vÃ  Kafka server trÆ°á»›c khi cháº¡y app.
- Äáº£m báº£o `localhost:9092` Ä‘ang má»Ÿ vÃ  khÃ´ng bá»‹ firewall cháº·n.
- Khi Kafka Ä‘Ã£ cháº¡y, app sáº½ gá»­i event thÃ nh cÃ´ng, khÃ´ng cÃ²n bÃ¡o lá»—i "No Kafka broker available".

### LÆ°u Ã½ khi gá»­i email thÃ´ng bÃ¡o Ä‘iá»ƒm danh

1. **Äáº£m báº£o trÆ°á»ng email cá»§a sinh viÃªn Ä‘Ã£ Ä‘Æ°á»£c lÆ°u trong database**
   - Khi Ä‘Äƒng kÃ½ hoáº·c nháº­p dá»¯ liá»‡u sinh viÃªn, cáº§n cÃ³ cá»™t `email` há»£p lá»‡ cho tá»«ng sinh viÃªn.
   - Náº¿u thiáº¿u email, há»‡ thá»‘ng sáº½ khÃ´ng gá»­i Ä‘Æ°á»£c thÃ´ng bÃ¡o cho sinh viÃªn Ä‘Ã³.

2. **Náº¿u dÃ¹ng Gmail Ä‘á»ƒ gá»­i email tá»± Ä‘á»™ng**
   - KhÃ´ng dÃ¹ng máº­t kháº©u Gmail thÃ´ng thÆ°á»ng, mÃ  pháº£i báº­t tÃ­nh nÄƒng "App Password" (Máº­t kháº©u á»©ng dá»¥ng) trong pháº§n báº£o máº­t tÃ i khoáº£n Google.
   - HÆ°á»›ng dáº«n:  
     - Truy cáº­p https://myaccount.google.com/security  
     - Báº­t xÃ¡c thá»±c 2 bÆ°á»›c (2-Step Verification).
     - Táº¡o "App Password" cho á»©ng dá»¥ng (chá»n loáº¡i app lÃ  "Mail", thiáº¿t bá»‹ lÃ  "Other").
     - Sá»­ dá»¥ng app password nÃ y trong code thay cho máº­t kháº©u Gmail.

3. **Náº¿u gá»­i nhiá»u email (nhiá»u sinh viÃªn/lá»›p lá»›n)**
   - NÃªn xá»­ lÃ½ gá»­i email theo kiá»ƒu báº¥t Ä‘á»“ng bá»™ (asynchronous) hoáº·c dÃ¹ng queue (vÃ­ dá»¥: Celery, RabbitMQ, Redis Queue) Ä‘á»ƒ trÃ¡nh gá»­i quÃ¡ nhanh dáº«n Ä‘áº¿n bá»‹ Google hoáº·c nhÃ  cung cáº¥p email cháº·n/táº¡m khÃ³a tÃ i khoáº£n.
   - CÃ³ thá»ƒ thÃªm delay nhá» giá»¯a cÃ¡c láº§n gá»­i hoáº·c gom nhÃ³m gá»­i theo batch.
   - Náº¿u gá»­i sá»‘ lÆ°á»£ng lá»›n, nÃªn dÃ¹ng dá»‹ch vá»¥ email chuyÃªn nghiá»‡p nhÆ° SendGrid, Amazon SES, Mailgun...

4. **Kiá»ƒm tra thÆ° má»¥c Spam**
   - Email gá»­i tá»± Ä‘á»™ng cÃ³ thá»ƒ bá»‹ vÃ o Spam, nÃªn hÆ°á»›ng dáº«n sinh viÃªn kiá»ƒm tra cáº£ thÆ° má»¥c Spam/Junk.

5. **Báº£o máº­t thÃ´ng tin**
   - KhÃ´ng lÆ°u trá»¯ app password hoáº·c thÃ´ng tin nháº¡y cáº£m trong code public hoáº·c repo cÃ´ng khai.

## Kiá»ƒm tra dá»¯ liá»‡u trong database SQLite

Báº¡n cÃ³ thá»ƒ kiá»ƒm tra dá»¯ liá»‡u trong file SQLite (`system.db`) báº±ng cÃ¡c cÃ¡ch sau:

### 1. DÃ¹ng lá»‡nh sqlite3 trÃªn terminal/cmd

- Má»Ÿ terminal/cmd, chuyá»ƒn Ä‘áº¿n thÆ° má»¥c chá»©a file `system.db`:
  ```
  cd database
  sqlite3 system.db
  ```
- Sau Ä‘Ã³, trong giao diá»‡n sqlite3:
  ```
  .tables
  SELECT * FROM users;
  SELECT * FROM attendance;
  SELECT name, seq FROM sqlite_sequence;
  .schema users
  .schema attendance
  .exit
  ```

### 2. DÃ¹ng DB Browser for SQLite (giao diá»‡n Ä‘á»“ há»a)

- Táº£i vÃ  cÃ i Ä‘áº·t [DB Browser for SQLite](https://sqlitebrowser.org/).
- Má»Ÿ file `system.db` Ä‘á»ƒ xem, sá»­a, truy váº¥n dá»¯ liá»‡u trá»±c quan.

### 3. DÃ¹ng Python vá»›i db_queries.py

Báº¡n cÃ³ thá»ƒ viáº¿t má»™t Ä‘oáº¡n script nhá» Ä‘á»ƒ kiá»ƒm tra dá»¯ liá»‡u, vÃ­ dá»¥:

````python
# filepath: check_db.py
from database.db_queries import fetch_users

users = fetch_users()
for user in users:
    print(user)
````

Hoáº·c tá»± viáº¿t truy váº¥n SQL vá»›i sqlite3:

````python
# filepath: check_db.py
import sqlite3

conn = sqlite3.connect('database/system.db')
cursor = conn.cursor()
cursor.execute("SELECT * FROM users")
for row in cursor.fetchall():
    print(row)
conn.close()
````

---

**TÃ³m láº¡i:**  
- CÃ³ thá»ƒ kiá»ƒm tra database báº±ng lá»‡nh sqlite3, pháº§n má»m DB Browser, hoáº·c code Python sá»­ dá»¥ng db_queries.py.
- NÃªn dÃ¹ng DB Browser for SQLite Ä‘á»ƒ xem dá»¯ liá»‡u trá»±c quan, dá»… thao tÃ¡c.

### Giáº£i thÃ­ch vá» báº£ng `sqlite_sequence` trong SQLite

- `sqlite_sequence` lÃ  báº£ng há»‡ thá»‘ng (system table) do SQLite tá»± Ä‘á»™ng táº¡o ra khi báº¡n sá»­ dá»¥ng cá»™t `AUTOINCREMENT` trong cÃ¡c báº£ng (vÃ­ dá»¥: `id INTEGER PRIMARY KEY AUTOINCREMENT`).
- Báº£ng nÃ y lÆ°u trá»¯ tÃªn báº£ng (`name`) vÃ  giÃ¡ trá»‹ tá»± tÄƒng hiá»‡n táº¡i (`seq`) cho má»—i báº£ng cÃ³ sá»­ dá»¥ng AUTOINCREMENT.
- Khi báº¡n thÃªm báº£n ghi má»›i vÃ o báº£ng cÃ³ AUTOINCREMENT, SQLite sáº½ tÄƒng giÃ¡ trá»‹ `seq` trong `sqlite_sequence` Ä‘á»ƒ Ä‘áº£m báº£o má»—i giÃ¡ trá»‹ lÃ  duy nháº¥t vÃ  khÃ´ng bá»‹ láº·p láº¡i, ká»ƒ cáº£ khi báº¡n xÃ³a báº£n ghi.

**VÃ­ dá»¥:**  
- Náº¿u báº¡n cÃ³ báº£ng `users` vá»›i `id INTEGER PRIMARY KEY AUTOINCREMENT`, thÃ¬ dÃ²ng tÆ°Æ¡ng á»©ng trong `sqlite_sequence` sáº½ cho biáº¿t giÃ¡ trá»‹ id lá»›n nháº¥t Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng cho báº£ng `users`.
- Khi báº¡n thÃªm báº£n ghi má»›i, id sáº½ tÄƒng tiáº¿p tá»« giÃ¡ trá»‹ nÃ y.

**Truy váº¥n:**  
```sql
SELECT name, seq FROM sqlite_sequence;
```
- Káº¿t quáº£ sáº½ cho báº¡n biáº¿t giÃ¡ trá»‹ tá»± tÄƒng hiá»‡n táº¡i cá»§a tá»«ng báº£ng.

**TÃ³m láº¡i:**  
- Báº¡n khÃ´ng cáº§n thao tÃ¡c trá»±c tiáº¿p vá»›i `sqlite_sequence` trong á»©ng dá»¥ng bÃ¬nh thÆ°á»ng.
- ÄÃ¢y lÃ  báº£ng há»‡ thá»‘ng giÃºp SQLite quáº£n lÃ½ giÃ¡ trá»‹ tá»± tÄƒng cho cÃ¡c báº£ng cÃ³ AUTOINCREMENT.